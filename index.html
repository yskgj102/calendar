<html>

<head>

	<title>勤務カレンダー</title>
	<meta http-equiv="Pragma" content="no-cache">
	<meta http-equiv="Cache-Control" content="no-cache">
	<link rel="stylesheet" href="./css/stylesheet.css">
	<script src="js/jquery-2.0.0.min.js"></script>
	<script src="https://embed.small.chat/TKD9QBQP2GKCQHV8DA.js" async></script>
	<script type="text/javascript">
		$(function() {
			//ページ内のaタグ群を取得。aTagsに配列として代入。
			var aTags = $('a');
			//全てのaタグについて処理
			aTags.each(function() {
				//aタグのhref属性からリンク先url取得
				var url = $(this).attr('href');
				//念のため、href属性は削除
				$(this).removeAttr('href');

				//クリックイベントをバインド
				$(this).click(function() {
					location.href = url;
				});
			});

		});
	</script>
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
	<link rel="apple-touch-icon" href="./img/tower.png">
	<style>
		* {
			-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
			-webkit-touch-callout: none;
			-webkit-user-select: none;
		}
	</style>
</head>

<body>


	<center>
		<div class=”center” style="font-size:30px;"><br>Calendar
		</div>
	</center>

	<!-- ここにページの内容を記述します -->
	<br><br>
	<center>
		<input type="date" id="setDate" value=""></center><br><br>
	<center>

		<table align="center" border="5" bordercolor="#339999" cellpadding="8" cellspacing="0">
			<script language="JavaScript" src="./js/calendar.js">
			</script>



			<script type="text/javascript" class="today">
				function displayToday() {
					var today = new Date();
					var dayOfWeek = today.getDay();
					var dayOfWeekStr = ["日", "月", "火", "水", "木", "金", "土"][dayOfWeek]; // 曜日(日本語表記)
					var text = today.getFullYear() + "/" + (today.getMonth() + 1) + "/" + today.getDate() + "(" + dayOfWeekStr + ")";
					document.write(text);
				}

				function displayPropertyTheDay(day) {

					var dayOfWeek = day.getDay();

					var day1 = new Date(2019, (5 - 1), 4);
					var day2 = new Date(day.getFullYear(), day.getMonth(), day.getDate());
					//差日を求める（86,400,000ミリ秒＝１日）

					var termDay = (Math.floor((day2 - day1) / 86400000));

					while (termDay < 0) {

						termDay += 6;
					}
					if (termDay % 6 == 1 || termDay % 6 == 2) {
						if (!(termDay % 6 == 2 && day2.getDay() == 0)) {
							if (!(termDay % 6 == 2 && day2.getDay() == 3)) {
								document.write("休日");
							}
						}
					}
					if (termDay % 6 == 0) {
						document.write("夜勤明け");
					}
					if ((termDay % 6 == 2 && day2.getDay() == 0) || (termDay % 6 == 2 && day2.getDay() == 3)) {
						document.write("早番");
					} else if (termDay % 6 == 3) {
						document.write("早番");
					}
					if (termDay % 6 == 4) {
						document.write("仕事");
					}
					if (termDay % 6 == 5) {
						document.write("夜勤");
					}

				}
				displayToday();
				document.write("　");

				var day = new Date();
				document.getElementById("setDate").onchange = function() {
					var date = document.getElementById("setDate").value;
					var url = './index?/' + date.split("-")[0] + '/' + date.split("-")[1] + '/';
					location.href = url;
					day = new Date(date.split("-")[0], date.split("-")[1], date.split("-")[2]);

				};

			var url = location.href ;
			day =new Date(url.split("/")[5],url.split("/")[6],1);
					displayPropertyTheDay(day);
			</script>
	</center>
	</table>


</body>
<footer>

	2019/05/14 ver 0.0 初版</br>
	2019/06/08 ver 0.1 チャット機能の実装、UI修正

</footer>


</html>
